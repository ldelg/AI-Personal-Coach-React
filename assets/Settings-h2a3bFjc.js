import{r as a,g as S,l as v,d as b,c as f,j as s}from"./index-DpazE5Un.js";import{u as I,a as N}from"./hooks-BVj7Wkg8.js";function L(){const n=I(),e=N(l=>l.chat.model),[m,r]=a.useState([]),[g,t]=a.useState(e.modelId||""),[h,d]=a.useState(null),[u,c]=a.useState(null);a.useEffect(()=>{S().then(l=>{l.length>0&&(r(l),t(o=>e.modelId&&l.includes(e.modelId)?e.modelId:o&&l.includes(o)?o:l[0]))})},[e.modelId]),a.useEffect(()=>{e.modelId&&m.includes(e.modelId)&&t(e.modelId)},[e.modelId,m]);const i=a.useCallback(async l=>{c(null);const o=await n(v(l));if(v.rejected.match(o)){const M=o.error?.message??"Failed to load model";c(String(M))}},[n]),p=a.useCallback(async l=>{d(l),c(null);try{await b(l),e.modelId===l&&(n(f.setModelLoaded(!1)),n(f.setModelId(void 0)))}catch(o){c(String(o instanceof Error?o.message:"Failed to remove model"))}finally{d(null)}},[n,e.modelId]),x=e.loaded&&e.modelId===g,j=e.loading;return{availableModels:m,selected:g,setSelected:t,removingModel:h,errorMsg:u,isLoading:j,isSelectedModelLoaded:x,modelState:e,handleLoad:i,handleRemove:p}}function R(){const{availableModels:n,selected:e,setSelected:m,removingModel:r,errorMsg:g,isLoading:t,isSelectedModelLoaded:h,modelState:d,handleLoad:u,handleRemove:c}=L();return s.jsx("div",{className:"settings-page",children:s.jsxs("div",{className:"settings-container",children:[s.jsx("h1",{children:"Settings"}),s.jsxs("section",{className:"settings-section",children:[s.jsx("h2",{children:"Models"}),s.jsx("p",{className:"settings-description",children:"Select a model to load into the browser (cached for offline use)."}),s.jsxs("div",{className:"settings-controls",children:[s.jsx("select",{className:"settings-select",value:e,onChange:i=>m(i.target.value),disabled:t||!!r,children:n.map(i=>s.jsx("option",{value:i,children:i},i))}),s.jsxs("div",{className:"settings-actions",children:[s.jsx("button",{className:"primary-btn",onClick:()=>u(e),disabled:t||!!r||h,title:h?"This model is already loaded":void 0,children:t?"Loading…":"Load"}),s.jsx("button",{className:"secondary-btn",onClick:()=>c(e),disabled:!d.loaded||t||!!r,title:d.loaded?void 0:"No model loaded",children:r===e?"Removing…":"Remove model"})]})]}),g&&s.jsx("div",{className:"model-error",children:g}),d.error&&s.jsx("div",{className:"model-error",children:d.error}),d.progress&&s.jsx("div",{className:"model-progress",children:d.progress})]})]})})}export{R as default};
